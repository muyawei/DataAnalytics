# -*- coding:utf-8 -*-
import pandas as pd


channel = [{'sum': 202, '_channel': u'360cn'}, {'sum': 4, '_channel': u'91Android'}, {'sum': 36, '_channel': u'aliyun'}, {'sum': 250, '_channel': u'baidu'}, {'sum': 369, '_channel': u'baidu_AD'}, {'sum': 2, '_channel': u'bbk'}, {'sum': 56, '_channel': u'drivers'}, {'sum': 5, '_channel': u'drivers_2'}, {'sum': 543, '_channel': u'gfan'}, {'sum': 1, '_channel': u'hiapk'}, {'sum': 523, '_channel': u'huawei'}, {'sum': 1, '_channel': u'jinli'}, {'sum': 62, '_channel': u'lemian'}, {'sum': 5, '_channel': u'lenovo'}, {'sum': 59, '_channel': u'leshi'}, {'sum': 1, '_channel': u'liantong'}, {'sum': 223, '_channel': u'meizu'}, {'sum': 501, '_channel': u'nearme'}, {'sum': 2, '_channel': u'pp'}, {'sum': 1225, '_channel': u'qq'}, {'sum': 74, '_channel': u'samsung'}, {'sum': 12, '_channel': u'smnfc'}, {'sum': 75, '_channel': u'sougoushouji'}, {'sum': 40, '_channel': u'wandoujia'}, {'sum': 119, '_channel': u'website'}, {'sum': 2, '_channel': u'website_360'}, {'sum': 5, '_channel': u'website_51xinyongka'}, {'sum': 16, '_channel': u'website_58'}, {'sum': 434, '_channel': u'website_baidu_wangmeng8'}, {'sum': 33, '_channel': u'website_buding'}, {'sum': 8, '_channel': u'website_duanxin1'}, {'sum': 10, '_channel': u'website_duanxin2'}, {'sum': 4, '_channel': u'website_haosou_360'}, {'sum': 186, '_channel': u'website_qqauto'}, {'sum': 1, '_channel': u'website_qqpc'}, {'sum': 339, '_channel': u'website_shenmasousuo1'}, {'sum': 12, '_channel': u'website_shenmasousuo3'}, {'sum': 5, '_channel': u'website_uc'}, {'sum': 6, '_channel': u'website_webqq'}, {'sum': 1, '_channel': u'weiche10'}, {'sum': 1, '_channel': u'weiche15'}, {'sum': 1, '_channel': u'WeicheNewTest'}, {'sum': 2, '_channel': u'WeicheTest'}, {'sum': 7, '_channel': u'WSLD'}, {'sum': 318, '_channel': u'xiaomi'}, {'sum': 1, '_channel': u'AstonMartinCarInsurance_iPhone'}, {'sum': 1, '_channel': u'AstonMartinLifeCar_iPhone'}, {'sum': 1111, '_channel': u'AstonMartinLifeDriver_iPhone'}, {'sum': 384, '_channel': u'AstonMartinLite_iPhone'}, {'sum': 20, '_channel': u'AstonMartinPerfect_iPhone'}, {'sum': 25, '_channel': u'AstonMartinViolation2014_iPhone'}, {'sum': 7895, '_channel': u'AstonMartinViolation2015_iPhone'}, {'sum': 278, '_channel': u'AstonMartinViolationLite2015_iPhone'}, {'sum': 4228, '_channel': u'AstonMartin_iPhone'}, {'sum': 1, '_channel': u'AstonMartin_iPhone_Lite'}]
channel_phone = [{'sum': 52, '_channel': u'360cn'}, {'sum': 1, '_channel': u'91Android'}, {'sum': 10, '_channel': u'aliyun'}, {'sum': 57, '_channel': u'baidu'}, {'sum': 92, '_channel': u'baidu_AD'}, {'sum': 1, '_channel': u'bbk'}, {'sum': 194, '_channel': u'gfan'}, {'sum': 143, '_channel': u'huawei'}, {'sum': 16, '_channel': u'lemian'}, {'sum': 4, '_channel': u'lenovo'}, {'sum': 19, '_channel': u'leshi'}, {'sum': 70, '_channel': u'meizu'}, {'sum': 129, '_channel': u'nearme'}, {'sum': 315, '_channel': u'qq'}, {'sum': 25, '_channel': u'samsung'}, {'sum': 4, '_channel': u'smnfc'}, {'sum': 22, '_channel': u'sougoushouji'}, {'sum': 3, '_channel': u'wandoujia'}, {'sum': 35, '_channel': u'website'}, {'sum': 2, '_channel': u'website_51xinyongka'}, {'sum': 2, '_channel': u'website_58'}, {'sum': 107, '_channel': u'website_baidu_wangmeng8'}, {'sum': 12, '_channel': u'website_buding'}, {'sum': 3, '_channel': u'website_duanxin1'}, {'sum': 4, '_channel': u'website_duanxin2'}, {'sum': 1, '_channel': u'website_haosou_360'}, {'sum': 50, '_channel': u'website_qqauto'}, {'sum': 1, '_channel': u'website_qqpc'}, {'sum': 75, '_channel': u'website_shenmasousuo1'}, {'sum': 2, '_channel': u'website_shenmasousuo3'}, {'sum': 2, '_channel': u'website_uc'}, {'sum': 2, '_channel': u'website_webqq'}, {'sum': 1, '_channel': u'weiche15'}, {'sum': 1, '_channel': u'WeicheTest'}, {'sum': 2, '_channel': u'WSLD'}, {'sum': 63, '_channel': u'xiaomi'}, {'sum': 2, '_channel': u'AstonMartinLifeDriver_iPhone'}, {'sum': 2, '_channel': u'AstonMartinLite_iPhone'}, {'sum': 13, '_channel': u'AstonMartinViolation2015_iPhone'}, {'sum': 3, '_channel': u'AstonMartinViolationLite2015_iPhone'}, {'sum': 1370, '_channel': u'AstonMartin_iPhone'}]
channel_weixin = [{'sum': 202, '_channel': u'360cn'}, {'sum': 4, '_channel': u'91Android'}, {'sum': 36, '_channel': u'aliyun'}, {'sum': 250, '_channel': u'baidu'}, {'sum': 369, '_channel': u'baidu_AD'}, {'sum': 2, '_channel': u'bbk'}, {'sum': 56, '_channel': u'drivers'}, {'sum': 5, '_channel': u'drivers_2'}, {'sum': 543, '_channel': u'gfan'}, {'sum': 1, '_channel': u'hiapk'}, {'sum': 523, '_channel': u'huawei'}, {'sum': 1, '_channel': u'jinli'}, {'sum': 62, '_channel': u'lemian'}, {'sum': 5, '_channel': u'lenovo'}, {'sum': 59, '_channel': u'leshi'}, {'sum': 1, '_channel': u'liantong'}, {'sum': 223, '_channel': u'meizu'}, {'sum': 501, '_channel': u'nearme'}, {'sum': 2, '_channel': u'pp'}, {'sum': 1225, '_channel': u'qq'}, {'sum': 74, '_channel': u'samsung'}, {'sum': 12, '_channel': u'smnfc'}, {'sum': 75, '_channel': u'sougoushouji'}, {'sum': 40, '_channel': u'wandoujia'}, {'sum': 119, '_channel': u'website'}, {'sum': 2, '_channel': u'website_360'}, {'sum': 5, '_channel': u'website_51xinyongka'}, {'sum': 16, '_channel': u'website_58'}, {'sum': 434, '_channel': u'website_baidu_wangmeng8'}, {'sum': 33, '_channel': u'website_buding'}, {'sum': 8, '_channel': u'website_duanxin1'}, {'sum': 10, '_channel': u'website_duanxin2'}, {'sum': 4, '_channel': u'website_haosou_360'}, {'sum': 186, '_channel': u'website_qqauto'}, {'sum': 1, '_channel': u'website_qqpc'}, {'sum': 339, '_channel': u'website_shenmasousuo1'}, {'sum': 12, '_channel': u'website_shenmasousuo3'}, {'sum': 5, '_channel': u'website_uc'}, {'sum': 6, '_channel': u'website_webqq'}, {'sum': 1, '_channel': u'weiche10'}, {'sum': 1, '_channel': u'weiche15'}, {'sum': 1, '_channel': u'WeicheNewTest'}, {'sum': 2, '_channel': u'WeicheTest'}, {'sum': 7, '_channel': u'WSLD'}, {'sum': 318, '_channel': u'xiaomi'}, {'sum': 1, '_channel': u'AstonMartinCarInsurance_iPhone'}, {'sum': 1, '_channel': u'AstonMartinLifeCar_iPhone'}, {'sum': 1111, '_channel': u'AstonMartinLifeDriver_iPhone'}, {'sum': 384, '_channel': u'AstonMartinLite_iPhone'}, {'sum': 20, '_channel': u'AstonMartinPerfect_iPhone'}, {'sum': 25, '_channel': u'AstonMartinViolation2014_iPhone'}, {'sum': 7895, '_channel': u'AstonMartinViolation2015_iPhone'}, {'sum': 278, '_channel': u'AstonMartinViolationLite2015_iPhone'}, {'sum': 4228, '_channel': u'AstonMartin_iPhone'}, {'sum': 1, '_channel': u'AstonMartin_iPhone_Lite'}]
channel_accum = [{'sum': 4, '_channel': u''}, {'sum': 290188, '_channel': u'360cn'}, {'sum': 16065, '_channel': u'360weishi'}, {'sum': 4072, '_channel': u'91table'}, {'sum': 460, '_channel': u'AstonMartinCarInsurance_iPhone'}, {'sum': 347, '_channel': u'AstonMartinLifeCar_iPhone'}, {'sum': 353965, '_channel': u'AstonMartinLifeDriver_iPhone'}, {'sum': 314702, '_channel': u'AstonMartinLite_iPhone'}, {'sum': 10463, '_channel': u'AstonMartinViolation2014_iPhone'}, {'sum': 2531988, '_channel': u'AstonMartin_iPhone'}, {'sum': 242, '_channel': u'AstonMartin_iPhone@apple'}, {'sum': 49, '_channel': u'AstonMartin_iPhone@taohuaduoduo'}, {'sum': 189, '_channel': u'AstonMartin_iPhone_25pp'}, {'sum': 1035, '_channel': u'AstonMartin_iPhone_Perfect'}, {'sum': 111, '_channel': u'AstonMartin_iPhone_funmovie'}, {'sum': 466, '_channel': u'AstonMartin_iPhone_i4'}, {'sum': 25, '_channel': u'AstonMartin_iPhone_kuaiapp'}, {'sum': 348, '_channel': u'AstonMartin_iPhone_kuaiyong'}, {'sum': 5051, '_channel': u'AstonMartin_iPhone_tongbu'}, {'sum': 13, '_channel': u'AstonMartin_iPhone_weiphone'}, {'sum': 34535, '_channel': u'AstonMartin_iPhone_xy'}, {'sum': 14, '_channel': u'HL_10'}, {'sum': 153, '_channel': u'HL_3'}, {'sum': 2, '_channel': u'HL_5'}, {'sum': 5, '_channel': u'HL_7'}, {'sum': 72, '_channel': u'HL_9'}, {'sum': 316, '_channel': u'Huawei_CPA'}, {'sum': 8, '_channel': u'QD_cpa6'}, {'sum': 98, '_channel': u'QD_jutu'}, {'sum': 2035, '_channel': u'Smartisan'}, {'sum': 1341, '_channel': u'WSLD'}, {'sum': 299, '_channel': u'ZQB_HL'}, {'sum': 12101, '_channel': u'aliyun'}, {'sum': 27, '_channel': u'baidu-tuiguang'}, {'sum': 2327, '_channel': u'baidu_SS'}, {'sum': 302, '_channel': u'baidu_tequan'}, {'sum': 6, '_channel': u'baidu_wangmeng'}, {'sum': 123, '_channel': u'c1'}, {'sum': 233, '_channel': u'c3'}, {'sum': 698, '_channel': u'c5'}, {'sum': 720, '_channel': u'dianhuabang'}, {'sum': 1220, '_channel': u'doov'}, {'sum': 749, '_channel': u'drivers_2'}, {'sum': 70, '_channel': u'exchange01'}, {'sum': 23, '_channel': u'exchange03'}, {'sum': 148055, '_channel': u'gfan'}, {'sum': 7083, '_channel': u'goapk'}, {'sum': 17, '_channel': u'guomei'}, {'sum': 1857, '_channel': u'hl_1'}, {'sum': 1094, '_channel': u'hl_7'}, {'sum': 7937, '_channel': u'jinli'}, {'sum': 2, '_channel': u'kupai'}, {'sum': 11363, '_channel': u'lemian'}, {'sum': 1782, '_channel': u'liantong'}, {'sum': 158, '_channel': u'liebao2'}, {'sum': 5684, '_channel': u'liebao_HL_2'}, {'sum': 72246, '_channel': u'meizu'}, {'sum': 2843, '_channel': u'mm'}, {'sum': 258, '_channel': u'mumayi'}, {'sum': 982, '_channel': u'nduo'}, {'sum': 188029, '_channel': u'nearme'}, {'sum': 34533, '_channel': u'pp'}, {'sum': 74, '_channel': u'ppqudao'}, {'sum': 478894, '_channel': u'qq'}, {'sum': 82, '_channel': u'qq_ad'}, {'sum': 20922, '_channel': u'samsung'}, {'sum': 262, '_channel': u'samsung_tab'}, {'sum': 8, '_channel': u'shenma'}, {'sum': 62629, '_channel': u'sougoushouji'}, {'sum': 1059, '_channel': u'taobao'}, {'sum': 12, '_channel': u'test'}, {'sum': 14, '_channel': u'tuba'}, {'sum': 155, '_channel': u'tydtech01'}, {'sum': 166, '_channel': u'uc'}, {'sum': 1757, '_channel': u'uc_cpd'}, {'sum': 44568, '_channel': u'wandoujia'}, {'sum': 2176, '_channel': u'wandoujia_AD'}, {'sum': 318, '_channel': u'webiste_uc'}, {'sum': 127, '_channel': u'website-kuchuan3'}, {'sum': 5, '_channel': u'website_360HS2'}, {'sum': 32, '_channel': u'website_360PC-roll'}, {'sum': 355, '_channel': u'website_360m-roll'}, {'sum': 422, '_channel': u'website_3g'}, {'sum': 601, '_channel': u'website_51xinyongka'}, {'sum': 3, '_channel': u'website_apc'}, {'sum': 1215, '_channel': u'website_baidu_wangmeng11'}, {'sum': 4057, '_channel': u'website_baidu_wangmeng13'}, {'sum': 1040, '_channel': u'website_baidu_wangmeng2'}, {'sum': 191, '_channel': u'website_baidu_wangmeng4'}, {'sum': 411, '_channel': u'website_baidu_wangmeng6'}, {'sum': 70800, '_channel': u'website_baidu_wangmeng8'}, {'sum': 2065, '_channel': u'website_duanxin1'}, {'sum': 1185, '_channel': u'website_hezi'}, {'sum': 16, '_channel': u'website_light'}, {'sum': 3, '_channel': u'website_pt_huangye'}, {'sum': 3357, '_channel': u'website_qq'}, {'sum': 89, '_channel': u'website_shenmasousuo2'}, {'sum': 226, '_channel': u'website_sogouPC'}, {'sum': 128, '_channel': u'website_sogou_haomatong'}, {'sum': 325, '_channel': u'website_suhang'}, {'sum': 310, '_channel': u'website_tianping'}, {'sum': 9720, '_channel': u'website_uc'}, {'sum': 2898, '_channel': u'website_webqq'}, {'sum': 773, '_channel': u'website_weibo'}, {'sum': 45, '_channel': u'website_xmds'}, {'sum': 669, '_channel': u'website_youyoudaohang'}, {'sum': 1040, '_channel': u'weiche1'}, {'sum': 9820, '_channel': u'weiche10'}, {'sum': 55, '_channel': u'weiche12'}, {'sum': 476, '_channel': u'weiche14'}, {'sum': 238, '_channel': u'weiche3'}, {'sum': 816, '_channel': u'weiche5'}, {'sum': 159, '_channel': u'weiche7'}, {'sum': 1323, '_channel': u'weiche9'}, {'sum': 4, '_channel': u'xiaomipad'}, {'sum': 429, '_channel': u'yingyonghui'}, {'sum': 110, '_channel': u'zet_tequan'}, {'sum': 6, '_channel': u'20160310114354079_M100065'}, {'sum': 24082, '_channel': u'360_mll'}, {'sum': 1976, '_channel': u'360tequan'}, {'sum': 109, '_channel': u'3gmenhu'}, {'sum': 102, '_channel': u'91Andriod'}, {'sum': 22860, '_channel': u'91Android'}, {'sum': 255, '_channel': u'AstonMartinGuangDongJiaoJing_iPhone'}, {'sum': 11623, '_channel': u'AstonMartinPerfect_iPhone'}, {'sum': 955699, '_channel': u'AstonMartinViolation2015_iPhone'}, {'sum': 119511, '_channel': u'AstonMartinViolationLite2015_iPhone'}, {'sum': 18796, '_channel': u'AstonMartin_iPhone_91'}, {'sum': 10, '_channel': u'AstonMartin_iPhone_91hl'}, {'sum': 9769, '_channel': u'AstonMartin_iPhone_Lite'}, {'sum': 603, '_channel': u'AstonMartin_iPhone_haima'}, {'sum': 5, '_channel': u'HL_4'}, {'sum': 595, '_channel': u'HL_6'}, {'sum': 262, '_channel': u'HL_8'}, {'sum': 41, '_channel': u'Martin'}, {'sum': 209, '_channel': u'TongButui'}, {'sum': 20, '_channel': u'WeicheNewTest'}, {'sum': 2334, '_channel': u'WeicheTest'}, {'sum': 162159, '_channel': u'baidu'}, {'sum': 49637, '_channel': u'baidu_AD'}, {'sum': 5, '_channel': u'baofeng_HL'}, {'sum': 843, '_channel': u'bbk'}, {'sum': 1744, '_channel': u'buding_martin'}, {'sum': 406, '_channel': u'c2'}, {'sum': 148, '_channel': u'c4'}, {'sum': 5, '_channel': u'coolapk'}, {'sum': 925, '_channel': u'dangle'}, {'sum': 19757, '_channel': u'drivers'}, {'sum': 405, '_channel': u'drivers_1'}, {'sum': 8, '_channel': u'eoemarket'}, {'sum': 23, '_channel': u'exchange02'}, {'sum': 2, '_channel': u'exchange06'}, {'sum': 221, '_channel': u'google'}, {'sum': 13547, '_channel': u'hiapk'}, {'sum': 1, '_channel': u'hl_2'}, {'sum': 20, '_channel': u'hl_4'}, {'sum': 1, '_channel': u'hl_8'}, {'sum': 310218, '_channel': u'huawei'}, {'sum': 4, '_channel': u'iqiyi'}, {'sum': 13268, '_channel': u'jinritoutiao'}, {'sum': 5, '_channel': u'jinshan'}, {'sum': 302, '_channel': u'jinshan2'}, {'sum': 11712, '_channel': u'lenovo'}, {'sum': 19073, '_channel': u'leshi'}, {'sum': 50, '_channel': u'liebao1'}, {'sum': 135, '_channel': u'liebao_HL'}, {'sum': 2102, '_channel': u'mojitianqi'}, {'sum': 378, '_channel': u'sina'}, {'sum': 2350, '_channel': u'smnfc'}, {'sum': 354, '_channel': u'sogou'}, {'sum': 28, '_channel': u'tieba'}, {'sum': 1124, '_channel': u'ucstore'}, {'sum': 158174, '_channel': u'website'}, {'sum': 10, '_channel': u'website-kuchuan2'}, {'sum': 263, '_channel': u'website-kuchuan4'}, {'sum': 5365, '_channel': u'website_360'}, {'sum': 1, '_channel': u'website_360HS1'}, {'sum': 132, '_channel': u'website_360light'}, {'sum': 9889, '_channel': u'website_58'}, {'sum': 817, '_channel': u'website_aichengshi'}, {'sum': 2, '_channel': u'website_baidu'}, {'sum': 563, '_channel': u'website_baidu_wangmeng1'}, {'sum': 1861, '_channel': u'website_baidu_wangmeng10'}, {'sum': 381, '_channel': u'website_baidu_wangmeng3'}, {'sum': 10276, '_channel': u'website_baidu_wangmeng5'}, {'sum': 16316, '_channel': u'website_baidu_wangmeng7'}, {'sum': 2969, '_channel': u'website_baidu_wangmeng9'}, {'sum': 53930, '_channel': u'website_buding'}, {'sum': 1, '_channel': u'website_dazhongdianping'}, {'sum': 4863, '_channel': u'website_duanxin2'}, {'sum': 145, '_channel': u'website_ganji'}, {'sum': 1422, '_channel': u'website_haosou_360'}, {'sum': 297, '_channel': u'website_kuchuan'}, {'sum': 20946, '_channel': u'website_qqauto'}, {'sum': 16606, '_channel': u'website_qqpc'}, {'sum': 83, '_channel': u'website_shanzi'}, {'sum': 33084, '_channel': u'website_shenmasousuo1'}, {'sum': 4678, '_channel': u'website_shenmasousuo3'}, {'sum': 115, '_channel': u'website_sougouPC'}, {'sum': 4, '_channel': u'website_xiaomi'}, {'sum': 110, '_channel': u'website_yisou'}, {'sum': 20, '_channel': u'weiche13'}, {'sum': 3742, '_channel': u'weiche15'}, {'sum': 6549, '_channel': u'weiche2'}, {'sum': 582, '_channel': u'weiche4'}, {'sum': 20, '_channel': u'weiche6'}, {'sum': 1013, '_channel': u'weiche8'}, {'sum': 296150, '_channel': u'xiaomi'}, {'sum': 78, '_channel': u'xunlei'}]
df_day = pd.DataFrame(channel)
df_weixin = pd.DataFrame(channel_weixin)
df_phone = pd.DataFrame(channel_phone)
df_accum = pd.DataFrame(channel_accum)

all_weixin = pd.merge(df_day, df_weixin, on="_channel", suffixes=("_all", "_weixin"))
print all_weixin
all_weixin_phone = pd.merge(all_weixin, df_phone, on="_channel")
# all_weixin_phone_accum = pd.merge(all_weixin_phone, df_accum, on="_channel")
all_weixin_phone_accum = pd.merge(all_weixin_phone, df_accum, on="_channel")
print all_weixin_phone_accum

test_list = [{"all": 22, "channel": "ios", "city": "hrb"},
             {"all": 32, "channel": "ios", "city": "bj"},
             {"all": 52, "channel": "ios", "city": "sd"},
             {"all": 22, "channel": "ios", "city": "dd"},
             {"all": 242, "channel": "ios", "city": "hb"},
             {"all": 22, "channel": "and", "city": "hrb"},
             {"all": 32, "channel": "and", "city": "bj"},
             {"all": 52, "channel": "and", "city": "sd"},
             {"all": 22, "channel": "and", "city": "dd"},
             {"all": 242, "channel": "and", "city": "hb"}
             ]

df = pd.DataFrame(test_list)
print df

df_real = df.pivot("channel", "city")
df_real[u"总订单"] = df_real.sum(axis=1, level=0)
df_real.index.name = u'渠道'
df_real.columns.name = u"省份"
print df_real
file_name = "aa.xls"
with pd.ExcelWriter(file_name) as writer:
    df_real.to_excel(writer, sheet_name="a")
    all_weixin_phone_accum.to_excel(writer, sheet_name="b")



